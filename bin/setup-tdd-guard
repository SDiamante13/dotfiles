#!/bin/bash
# TDD Guard Centralized Setup Script
# Links project's tdd-guard instructions to centralized dotfiles version

set -e

PROJECT_TDD_DIR=".claude/tdd-guard/data"
CENTRAL_INSTRUCTIONS="$HOME/.claude/tdd-guard/instructions.md"

echo "🔧 Setting up centralized TDD Guard instructions..."

# Create the project tdd-guard directory if it doesn't exist
if [ ! -d "$PROJECT_TDD_DIR" ]; then
    echo "📁 Creating $PROJECT_TDD_DIR directory..."
    mkdir -p "$PROJECT_TDD_DIR"
fi

# Remove existing instructions.md if it exists
if [ -f "$PROJECT_TDD_DIR/instructions.md" ]; then
    echo "🗑️  Removing existing instructions.md..."
    rm "$PROJECT_TDD_DIR/instructions.md"
fi

# Create symlink to centralized instructions
echo "🔗 Linking to centralized instructions..."
ln -s "$CENTRAL_INSTRUCTIONS" "$PROJECT_TDD_DIR/instructions.md"

echo "✅ TDD Guard setup complete!"
echo "   Project now uses centralized instructions from: $CENTRAL_INSTRUCTIONS"
echo "   Local link created at: $PROJECT_TDD_DIR/instructions.md"